<div class="row">
  <div class="col-xs-8">
    <%= form_tag demo_generate_path, :remote => true do %>
      <div class="col-xs-6">
        <div class="form-group">
          <%= text_field_tag :title, '', class: 'form-control', placeholder: 'Title' %>
        </div>

        <div class="form-group">
          <%= number_field_tag :cells, 4, { class: 'form-control', min: 2, max: 16} %>
        </div>

        <div class="checkbox">
          <label>
            <%= check_box_tag :axe_x %> Eje X
          </label>

          <label>
            <%= check_box_tag :axe_y %> Eje Y
          </label>
        </div>

        <%= text_field_tag :seed, '', class: 'form-control', placeholder: 'Seed' %>

        
        <%= submit_tag 'Generate' %>
      </div>

      <div class="col-xs-6">
        <div id="color_list">
          <%= render partial: 'demo/color_picker' %>
        </div>

        <%= link_to 'AÃ±adir color', '#', :id => "add_color" %>
      </div>
    <% end %>
  </div>

  <div class="col-xs-4">
    <%= image_tag "data:image/svg+xml;utf8, #{raw(@image)}", width: "200px", id: "example", class: 'svg-img img-responsive' %>
  </div>



</div>
  <div id="div_command" class="well well-sm">RubyRandimage.create(:title => title, :colors => colors, :symmetry_axes=> [axe_x, axe_y], :num_cells => cells)</div>

<script type="text/javascript">

  $("#add_color").click(function(){
    $("#color_list").append("<%= escape_javascript(render partial: 'demo/color_picker') %>");
  });


  $(document).ready(function(){
    

    $(document).on("change", "input.color", function()
    {
      state_chaged();
    });

    state_chaged();

  });

  $("#title").keyup(function(){
    state_chaged();
  });
  
  $("#cells").keyup(function(){
    state_chaged();
  });

  $("#cells").change(function(){
    state_chaged();
  });

  $("#seed").keyup(function(){
    state_chaged();
  });

  $("#axe_x").change(function(){
    state_chaged();
  });

  $("#axe_y").change(function(){
    state_chaged();
  });



  function state_chaged()
  {
    colors = [];
    $.each($("input.color"), function(){
      colors.push($(this).val());
    });

    
    gem_command = get_command($("#title").val(), $("#cells").val(), colors 
                  , [ $("#axe_x").is(':checked'), $("#axe_y").is(':checked')], $("#seed").val() );

    
    $('#div_command').text(gem_command);
  }

</script>
